language: cpp
compiler: gcc
before_install:
 - sudo apt-get update -y
 - sudo apt-get install -y libxml2-dev libxerces-c-dev python-svn python-lxml astyle libboost-all-dev xsdcxx default-jre libssl-dev gcc-multilib g++-multilib
 - wget --no-check-certificate https://cmake.org/files/v2.8/cmake-2.8.12.2.tar.gz
 - tar -xzvf cmake-2.8.12.2.tar.gz 
 - cd cmake-2.8.12.2
 - ./bootstrap
 - make      
 - sudo make install
 - cd ..
 
script:
 #- git clone -b backend_open62541 https://github.com/quasar-team/quasar.git
 - git clone https://github.com/quasar-team/open62541-compat.git
 - git clone https://github.com/quasar-team/quasar-validation-ci.git
 #- mkdir open62541
 #- mkdir open62541/src
 #- mkdir open62541/include
 - mv quasar-validation-ci/CI/open62541CI/open62541folderCMakeLists.txt open62541/CMakeLists.txt
 - mv quasar-validation-ci/CI/Design.xml Design/
 - mv quasar-validation-ci/CI/config.xml bin/
 #- sudo mv open62541-compat/ quasar/
#links from cernbox are not permanent, be carefull

 #- wget -O open62541/src/open62541.c --no-check-certificat https://cernbox.cern.ch/index.php/s/RbxN9UP2iWz04ra/download
 #- wget -O open62541/include/open62541.h --no-check-certificat https://cernbox.cern.ch/index.php/s/l9jPKvmI4l2CogC/download
 
 #preparte.sh clones open6 and compiles it with the options we need.
 - cd open62541-compat
 - sh prepare.sh
 - cd ..
 
 - python quasar.py external_tool_check
 - python quasar.py generate device GreenLED
 - python quasar.py generate device YellowLED
 - python quasar.py generate device RedLED
 - sudo chmod 777 -R *
#set environment vars, then invoke build
 - export BOOST_LIBS="-lboost_thread -lboost_system"
 - python quasar.py build Release open62541_config.cmake
